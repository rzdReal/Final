<!DOCTYPE html>
<html>
<body>
    <textarea id="message" rows="20" cols="205"></textarea>
    <button onclick="send()">Send</button>
    <div id='messages'></div>
    <script>
        const getElement = (id) => document.getElementById(id);
        fs = require('fs');
        fs.readFile('input.txt', 'utf8', function (err, data) {
            if (err) {
                return console.log(err);
            }
            console.log("reading data is finished")
            console.log(data);
            getElement('message').value = data;
        });
        const addMessage = (message) => {
            const pTag = document.createElement('p');
            pTag.appendChild(document.createTextNode(message));
            getElement('messages').appendChild(pTag);
        };
        const ws = new WebSocket('ws://localhost:4500');
        ws.onopen = () => {
            console.log('Now connected');
        };
        ws.onmessage = (event) => {
            const messages = JSON.parse(event.data);
            messages.forEach(addMessage);
        };
        const send = () => {
            var message = getElement('message').value
            console.log(message)
            ws.send(message)
            getElement('message').value = '';
        };
    </script>
</body>

</html>